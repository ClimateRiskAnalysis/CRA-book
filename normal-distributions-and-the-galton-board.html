<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 4 Normal distributions and the Galton board | Climate Risk Analysis" />
<meta property="og:type" content="book" />

<meta property="og:image" content="/images/cover_with_alexander.png" />

<meta name="github-repo" content="vsrikrish/CRA-book" />

<meta name="author" content="Vivek Srikrishnan" />
<meta name="author" content="Klaus Keller" />

<meta name="date" content="2021-12-15" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="Chapter 4 Normal distributions and the Galton board | Climate Risk Analysis">

<title>Chapter 4 Normal distributions and the Galton board | Climate Risk Analysis</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script>
function copy_link(id) {
  var dummy = document.createElement('input'),
  text = window.location.href.split(/[?#]/)[0] + '#' + id;
  document.body.appendChild(dummy);
  dummy.value = text;
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);
  
  var tooltip = document.getElementById(id + '-tooltip');
  tooltip.innerHTML = 'Copied!';
}

function reset_tooltip(id) {
  var tooltip = document.getElementById(id);
  tooltip.innerHTML = 'Copy link';
}
</script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>



<link rel="stylesheet" href="css/style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Climate Risk Analysis<p><p class="author">Vivek Srikrishnan, Klaus Keller</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Preface</a>
<a href="about-this-book.html">About This Book</a>
<a href="what-is-climate-risk.html"><span class="toc-section-number">1</span> What is Climate Risk?</a>
<a href="julia-syntax.html"><span class="toc-section-number">2</span> Learning the basics of Julia</a>
<a href="plotting-time-series-data.html"><span class="toc-section-number">3</span> Plotting Time Series Data</a>
<a id="active-page" href="normal-distributions-and-the-galton-board.html"><span class="toc-section-number">4</span> Normal distributions and the Galton board</a><ul class="toc-sections">
<li class="toc"><a href="#introduction-2"> Introduction</a></li>
<li class="toc"><a href="#tutorial-1"> Tutorial</a></li>
<li class="toc"><a href="#exercises-1"> Exercises</a></li>
</ul>
<a href="markov-chain-monte-carlo.html"><span class="toc-section-number">5</span> Markov Chain Monte Carlo</a>
<a href="references.html">References</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="normal-distributions-and-the-galton-board" class="section level1">
<h1>
<span class="header-section-number">Chapter 4</span> Normal distributions and the Galton board</h1>
<p>This chapter was written by Patrick J. Applegate and Vivek Srikrishnan.</p>
<div id="learning-objectives-2" class="section level3 unnumbered">
<h3>Learning objectives<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('learning-objectives-2')" onmouseout="reset_tooltip('learning-objectives-2-tooltip')"><span class="tooltiptext" id="learning-objectives-2-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>After completing this chapter, you should be able to</p>
<ul>
<li>describe under what circumstances normal distributions arise</li>
<li>use quantile-quantile plots to determine whether individual data sets are approximately normal or not</li>
<li>write simple <code>for</code> loops in Julia</li>
</ul>
</div>
<div id="introduction-2" class="section level2">
<h2>
<span class="header-section-number">4.1</span> Introduction<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('introduction-2')" onmouseout="reset_tooltip('introduction-2-tooltip')"><span class="tooltiptext" id="introduction-2-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Suppose that we ask a class of students to walk individually from one end of a field to the other and count the number of steps that they take in order to cover the distance. More than likely, each student will get a somewhat different answer. After each student has paced off the field, we then make a histogram of the number of steps taken by the individual students.</p>
<p>If we were to perform this experiment with a large number of students, the histogram would likely resemble a normal distribution. Normal distributions arise when a large number of measurements are taken of a single quantity, and the individual measurements are affected by random processes that are additive and that can be either positive or negative. The general property that a sufficiently large random sample will be well-described by a normal distribution is called the <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">Central Limit Theorem</a>, which is foundational in statistics (the details of the Central Limit Theorem are not essential for this book). In our example, the random processes have to do with the varying stride lengths of the students (some take longer strides and some shorter), and counting errors (which are likely to be small and can cause any given student to either over- or underestimate the actual number of paces they took).</p>
<p>A <a href="http://mathworld.wolfram.com/GaltonBoard.html">Galton board</a> is a physical device that demonstrates this concept (Fig. <a href="normal-distributions-and-the-galton-board.html#fig:galton">4.1</a>). A Galton board has rows of pins arranged in a triangular shape, with each row of pins offset horizontally relative to the rows above and below it. The top row has one pin, the second row has two pins, and so forth.</p>
<p>If a ball is dropped into the Galton board, it falls either to the right or the left when it bounces off the top pin. The ball then falls all the way to the bottom of the board, moving slightly to the right or left as it passes through each row of pins. Bins at the bottom of the board capture the ball and record its final position. If this experiment is repeated with many balls, and if the Galton board includes many rows of pins, the number of balls in each bin resembles a normal distribution (Fig. <a href="normal-distributions-and-the-galton-board.html#fig:galton">4.1</a>).</p>
<div class="figure">
<span style="display:block;" id="fig:galton"></span>
<p class="caption marginnote shownote">
Figure 4.1: A Galton board simulation with 15 rows of pins. The top panel shows the board and one sample ball trajectory. The bottom panel shows one possible distribution of final ball positions resulting from dropping 1000 balls through the board.
</p>
<img src="raes_files/figure-html/galton-J1.png" alt="A Galton board simulation with 15 rows of pins. The top panel shows the board and one sample ball trajectory. The bottom panel shows one possible distribution of final ball positions resulting from dropping 1000 balls through the board.">
</div>
<p>In this exercise, you’ll experiment with a simple representation of a Galton board in Julia and examine the distributions of final ball positions that it produces. You’ll also examine two data sets that can easily be loaded into Julia and see whether they are well described by a normal distribution or not.</p>
</div>
<div id="tutorial-1" class="section level2">
<h2>
<span class="header-section-number">4.2</span> Tutorial<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('tutorial-1')" onmouseout="reset_tooltip('tutorial-1-tooltip')"><span class="tooltiptext" id="tutorial-1-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<div id="writing-our-own-simple-galton-board-script" class="section level3">
<h3>
<span class="header-section-number">4.2.1</span> Writing our own simple Galton board script<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('writing-our-own-simple-galton-board-script')" onmouseout="reset_tooltip('writing-our-own-simple-galton-board-script-tooltip')"><span class="tooltiptext" id="writing-our-own-simple-galton-board-script-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>Building computer models involves thinking about how to represent the behavior of physical (or chemical, or social) systems in a form that can be understood by a computer. In thinking about how we could represent the Galton board in terms of Julia code, we might start by looking at the diagram of the Galton board in the top part of Figure <a href="normal-distributions-and-the-galton-board.html#fig:galton">4.1</a>. The horizontal spacing between the pins is always the same, but the rows are offset relative to one another; that is, none of the pins in any given row are immediately above or below the pins in the adjacent rows. This offset is exactly half of the horizontal spacing between pins in the same row. Thus, we can imagine that the ball bounces 0.5 distance units to one side whenever it hits a pin.</p>
<p>We first need to specify the number of levels in the Galton board.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb16-1"><a href="normal-distributions-and-the-galton-board.html#cb16-1"></a>levels = <span class="fl">15</span></span></code></pre></div>
<pre class="code-out"><code>## 15</code></pre>
<p>We can then represent the path that a single ball takes through the Galton board by randomly sampling how an individual ball bounces as it hits each pin. The Julia package which allows us to do random sampling is <code>Random.jl</code>, which is built into Julia’s basic distribution. The function which we call is <code>rand()</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb18-1"><a href="normal-distributions-and-the-galton-board.html#cb18-1"></a><span class="co"># load the `Random` package</span></span>
<span id="cb18-2"><a href="normal-distributions-and-the-galton-board.html#cb18-2"></a>using Random</span>
<span id="cb18-3"><a href="normal-distributions-and-the-galton-board.html#cb18-3"></a></span>
<span id="cb18-4"><a href="normal-distributions-and-the-galton-board.html#cb18-4"></a><span class="co"># sample</span></span>
<span id="cb18-5"><a href="normal-distributions-and-the-galton-board.html#cb18-5"></a>path = rand([-<span class="fl">0.5</span>, <span class="fl">0.5</span>], levels)</span></code></pre></div>
<pre class="code-out"><code>## 15-element Vector{Float64}:
##   0.5
##   0.5
##  -0.5
##   0.5
##  -0.5
##   0.5
##   0.5
##   0.5
##  -0.5
##  -0.5
##  -0.5
##  -0.5
##   0.5
##  -0.5
##   0.5</code></pre>
<p>Positive values indicates that the ball bounces to the right; negative values indicate that the ball bounces to the left.</p>
<p>The <code>rand()</code> command generates sequences of values that come from a vector of possibilities supplied in the first argument. The second argument is <code>dims</code>, the dimension of the final sample set. In this case, we are just sampling a single trajectory, so we just need a number of samples equal to <code>levels</code>, which will return a 1-dimensional array.</p>
<p>The bin that the ball lands in is then just</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb20-1"><a href="normal-distributions-and-the-galton-board.html#cb20-1"></a>sum(path)</span></code></pre></div>
<pre class="code-out"><code>## 0.5</code></pre>
</div>
<div id="doing-things-over-and-over-again-for-loops" class="section level3">
<h3>
<span class="header-section-number">4.2.2</span> Doing things over and over again: <code>for</code> loops<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('doing-things-over-and-over-again-for-loops')" onmouseout="reset_tooltip('doing-things-over-and-over-again-for-loops-tooltip')"><span class="tooltiptext" id="doing-things-over-and-over-again-for-loops-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>The commands above tell us about the path that any single ball takes through the Galton board, as well as the bin it finally lands in. But, suppose we want to write a piece of R code that performs this calculation for many balls and gives us a histogram of the bins that they land in. How could we do that?</p>
<p>Most, perhaps all, programming languages include a method for carrying out a set of instructions a fixed number of times. In most programming languages, including Julia, this method is called a <code>for</code> loop. The syntax of <code>for</code> loops in Julia looks like this:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb22-1"><a href="normal-distributions-and-the-galton-board.html#cb22-1"></a><span class="co"># set the number of times the loop should be evaluated; </span></span>
<span id="cb22-2"><a href="normal-distributions-and-the-galton-board.html#cb22-2"></a><span class="co"># this is not part of the for loop syntax</span></span>
<span id="cb22-3"><a href="normal-distributions-and-the-galton-board.html#cb22-3"></a>neval = <span class="fl">3</span>; </span>
<span id="cb22-4"><a href="normal-distributions-and-the-galton-board.html#cb22-4"></a><span class="kw">for</span> i = <span class="fl">1</span>:neval</span>
<span id="cb22-5"><a href="normal-distributions-and-the-galton-board.html#cb22-5"></a>  <span class="co"># instructions to be repeated go here </span></span>
<span id="cb22-6"><a href="normal-distributions-and-the-galton-board.html#cb22-6"></a>  println(i^<span class="fl">2</span>)</span>
<span id="cb22-7"><a href="normal-distributions-and-the-galton-board.html#cb22-7"></a><span class="kw">end</span> </span></code></pre></div>
<pre class="code-out"><code>## 1
## 4
## 9</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb24-1"><a href="normal-distributions-and-the-galton-board.html#cb24-1"></a><span class="co"># note the end; this is required to tell Julia where the </span></span>
<span id="cb24-2"><a href="normal-distributions-and-the-galton-board.html#cb24-2"></a><span class="co"># loop instructions end!</span></span></code></pre></div>
<p>This sample <code>for</code> loop is not very exciting: it simply <code>println()</code>s the square of the <em>index variable</em> <code>i</code> during each iteration of the indented commands (between <code>for</code> and <code>end</code>).</p>
<p>In “real” <code>for</code> loops, the name of the index variable, the vector of values that the index variable can take (here <code>1:neval</code>), and the evaluated instructions can be more complex. In particular, there can be more than one line of instructions evaluated. In Julia, you can also iterate over arbitrary collections, such as arrays, not just sequences of index variables.</p>
<p>We usually will want to create a variable that will store the results from the commands carried out within the <code>for</code> loop. The following block of code generates and <code>print()</code>s the first five <a href="https://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci numbers</a>:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb25-1"><a href="normal-distributions-and-the-galton-board.html#cb25-1"></a>neval = <span class="fl">5</span> </span></code></pre></div>
<pre class="code-out"><code>## 5</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb27-1"><a href="normal-distributions-and-the-galton-board.html#cb27-1"></a> <span class="co"># make a vector of `neval` zeroes, which will store the output</span></span>
<span id="cb27-2"><a href="normal-distributions-and-the-galton-board.html#cb27-2"></a>fibonacci = zeros(neval)</span></code></pre></div>
<pre class="code-out"><code>## 5-element Vector{Float64}:
##  0.0
##  0.0
##  0.0
##  0.0
##  0.0</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb29-1"><a href="normal-distributions-and-the-galton-board.html#cb29-1"></a><span class="kw">for</span> i = <span class="fl">3</span>:neval</span>
<span id="cb29-2"><a href="normal-distributions-and-the-galton-board.html#cb29-2"></a>  <span class="co"># initialize first two Fibonacci numbers; the first element is zero </span></span>
<span id="cb29-3"><a href="normal-distributions-and-the-galton-board.html#cb29-3"></a>  <span class="co"># and the second element is one</span></span>
<span id="cb29-4"><a href="normal-distributions-and-the-galton-board.html#cb29-4"></a>  fibonacci[<span class="fl">2</span>] = <span class="fl">1</span></span>
<span id="cb29-5"><a href="normal-distributions-and-the-galton-board.html#cb29-5"></a>  <span class="co"># stores the sum of the preceding two elements of `fibonacci` </span></span>
<span id="cb29-6"><a href="normal-distributions-and-the-galton-board.html#cb29-6"></a>  <span class="co"># in the ith element of `fibonacci`</span></span>
<span id="cb29-7"><a href="normal-distributions-and-the-galton-board.html#cb29-7"></a>  fibonacci[i] = sum(fibonacci[i-<span class="fl">2</span>:i-<span class="fl">1</span>])</span>
<span id="cb29-8"><a href="normal-distributions-and-the-galton-board.html#cb29-8"></a><span class="kw">end</span></span>
<span id="cb29-9"><a href="normal-distributions-and-the-galton-board.html#cb29-9"></a>println(fibonacci)</span></code></pre></div>
<pre class="code-out"><code>## [0.0, 1.0, 1.0, 2.0, 3.0]</code></pre>
<p>In general, it’s good practice to pre-allocate storage for the output of <code>for</code> loops as we did by defining the <code>fibonacci</code> array. If we were to just start with the initial two Fibonacci numbers and add to the length of the array at each iteration, this would slow down the program’s execution due to the need to assign new memory to the resulting array every time it grew. This might not be noticeable for the code block above due to the small number of evaluations, but it will be for more complex code.</p>
<p>In the Exercise below, you’ll put together the information above to write your own script for making histograms of the outcomes from a Galton board. First, though, let’s examine how we determine whether a particular data set is normal or not.</p>
</div>
<div id="normal-or-not-normal-generating-and-interpreting-quantile-quantile-plots" class="section level3">
<h3>
<span class="header-section-number">4.2.3</span> Normal or not normal?: Generating and interpreting quantile-quantile plots<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('normal-or-not-normal-generating-and-interpreting-quantile-quantile-plots')" onmouseout="reset_tooltip('normal-or-not-normal-generating-and-interpreting-quantile-quantile-plots-tooltip')"><span class="tooltiptext" id="normal-or-not-normal-generating-and-interpreting-quantile-quantile-plots-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>It can be tempting to assume that a particular process gives normally-distributed output, or that data are normally distributed; however, assuming normality when it isn’t present can lead to large errors. How can we check individual data sets for normality?</p>
<p>One robust and simple, but approximate, test for normality involves making a <a href="https://en.wikipedia.org/wiki/Q-Q_plot">quantile-quantile (Q-Q) plot</a>. The details of how Q-Q plots work aren’t important for our purposes here. However, if data are drawn from a normal distribution, they will lie on a line connecting the first and third quartiles of the data when drawn on an appropriately-constructed Q-Q plot. The <a href="https://github.com/JuliaPlots/StatsPlots.jl"><code>StatsPlots.jl</code> package</a> makes drawing Q-Q plots easy.</p>
<p>To see how this looks, let’s examine samples from different distributions. We can do this using the <code>Distributions.jl</code> package, which lets us specify distributions to sample from. We can then use <code>rand()</code> from the</p>
<p>For example, the following block of code generates 100 random numbers from a normal distribution, makes a Q-Q plot from them, and draws a 1:1 line on the plot:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb31-1"><a href="normal-distributions-and-the-galton-board.html#cb31-1"></a><span class="co"># load the packages we will use</span></span>
<span id="cb31-2"><a href="normal-distributions-and-the-galton-board.html#cb31-2"></a>using Distributions</span>
<span id="cb31-3"><a href="normal-distributions-and-the-galton-board.html#cb31-3"></a>using Random</span>
<span id="cb31-4"><a href="normal-distributions-and-the-galton-board.html#cb31-4"></a>using StatsPlots</span>
<span id="cb31-5"><a href="normal-distributions-and-the-galton-board.html#cb31-5"></a></span>
<span id="cb31-6"><a href="normal-distributions-and-the-galton-board.html#cb31-6"></a><span class="co"># specify the normal distribution with mean = 0 </span></span>
<span id="cb31-7"><a href="normal-distributions-and-the-galton-board.html#cb31-7"></a><span class="co"># snd standard deviation = 1, which are the default choices</span></span>
<span id="cb31-8"><a href="normal-distributions-and-the-galton-board.html#cb31-8"></a>normal_distribution = Normal();</span>
<span id="cb31-9"><a href="normal-distributions-and-the-galton-board.html#cb31-9"></a><span class="co"># draw 100 samples</span></span>
<span id="cb31-10"><a href="normal-distributions-and-the-galton-board.html#cb31-10"></a>normal_samples = rand(normal_distribution, <span class="fl">100</span>);</span>
<span id="cb31-11"><a href="normal-distributions-and-the-galton-board.html#cb31-11"></a><span class="co"># make the Q-Q plot</span></span>
<span id="cb31-12"><a href="normal-distributions-and-the-galton-board.html#cb31-12"></a>qqplot(Normal(), normal_samples) </span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:qqnormal"></span>
<p class="caption marginnote shownote">
Figure 4.2: A Q-Q plot showing 100 normally-distributed random values. The points, which represent the random values, lie approximately on the line, showing that their distribution could be treated as a normal distribution.
</p>
<img src="raes_files/figure-html/qqnormal-J1.png" alt="A Q-Q plot showing 100 normally-distributed random values.  The points, which represent the random values, lie approximately on the line, showing that their distribution could be treated as a normal distribution.">
</div>
<p>If we have a data set, we might not know what the parameters of the normal distribution are for the comparison (in this case, they were just the defaults). One strategy is to use the sample mean and standard deviation, which can be obtained with <code>mean()</code> and <code>std()</code> (this is justified by the Central Limit Theorem).</p>
<p>Let’s see what a Q-Q plot might look like if we draw samples from a distribution that isn’t normal. We will sample from a <a href="https://en.wikipedia.org/wiki/Cauchy_distribution">Cauchy distribution</a>, which is a distribution which has a higher probability of extreme values than a normal distribution.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb32-1"><a href="normal-distributions-and-the-galton-board.html#cb32-1"></a><span class="co"># specify the default Cauchy distribution </span></span>
<span id="cb32-2"><a href="normal-distributions-and-the-galton-board.html#cb32-2"></a>cauchy_distribution = Cauchy();</span>
<span id="cb32-3"><a href="normal-distributions-and-the-galton-board.html#cb32-3"></a><span class="co"># draw 100 samples</span></span>
<span id="cb32-4"><a href="normal-distributions-and-the-galton-board.html#cb32-4"></a>cauchy_samples = rand(cauchy_distribution, <span class="fl">100</span>);</span>
<span id="cb32-5"><a href="normal-distributions-and-the-galton-board.html#cb32-5"></a><span class="co"># make the Q-Q plot</span></span>
<span id="cb32-6"><a href="normal-distributions-and-the-galton-board.html#cb32-6"></a>qqplot(Normal(), cauchy_samples) </span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:qqcauchy"></span>
<p class="caption marginnote shownote">
Figure 4.3: A Q-Q plot showing 100 Cauchy-distributed random values. The points, which represent the random values, do not lie on the line for the majority of the plot. In this case, it could be dangerous to assume that the data were normally-distributed.
</p>
<img src="raes_files/figure-html/qqcauchy-J1.png" alt="A Q-Q plot showing 100 Cauchy-distributed random values.  The points, which represent the random values, do not lie on the line for the majority of the plot. In this case, it could be dangerous to assume that the data were normally-distributed.">
</div>
<p>Unlike in Figure <a href="normal-distributions-and-the-galton-board.html#fig:qqnormal">4.2</a>, the points in Figure <a href="normal-distributions-and-the-galton-board.html#fig:qqcauchy">4.3</a> are generally not along the line, which should suggest to use that the data are not normally distributed. On the left side of the Q-Q plot, the points are well below the line, and on the right side, they are well above it. This actually gives us more information about how the sample deviates from being normally distributed! The fact that the left side is below the line shows us that the distribution is “fatter” below the mean than a normal distribution, or that its left tail is heavier than that of a normal distribution. This is because a normal distribution’s samples are more limited in range than the samples from the Cauchy distribution. This means that it is more likely to see large negative values in this sample than we would expect from a normal sample. Similarly, the right side being above the line shows us that large positive values are more present than we would expect from a normal sample, and the right tail is fatter than a normal distribution’s. If the points and the line had the opposite relationship, we could conclude that the sample had thinner tails, and was more concentrated, than would be expected from a normal distribution. And if we had a mixed situation, that would suggest to us that our sample was more skewed to one side or the other.</p>
</div>
</div>
<div id="exercises-1" class="section level2">
<h2>
<span class="header-section-number">4.3</span> Exercises<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('exercises-1')" onmouseout="reset_tooltip('exercises-1-tooltip')"><span class="tooltiptext" id="exercises-1-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<div id="part-1-1" class="section level3 unlisted unnumbered">
<h3>Part 1<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('part-1-1')" onmouseout="reset_tooltip('part-1-1-tooltip')"><span class="tooltiptext" id="part-1-1-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>Based on the information presented in this chapter, write a Julia script that</p>
<ol style="list-style-type: decimal">
<li>sets values for the number of balls to drop and the number of rows of pins in the Galton board (you might use the variable names <code>nballs</code> and <code>levels</code>)</li>
<li>creates a vector <code>output</code> that contains a number of elements equal to <code>nballs</code>; these elements can be populated with <code>0</code>s or <code>nothing</code>s to start;</li>
<li>uses a <code>for</code> loop that</li>
</ol>
<ul>
<li>runs through values of the index variable <code>i</code> from <code>1:nballs</code>,</li>
<li>determines which bin of the Galton board each ball lands in, and</li>
<li>stores these values in the different elements of <code>output</code>
</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>makes a histogram of <code>output</code>. The code block below shows one way of carrying out this step.</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb33-1"><a href="normal-distributions-and-the-galton-board.html#cb33-1"></a><span class="co"># Make a histogram of the results.</span></span>
<span id="cb33-2"><a href="normal-distributions-and-the-galton-board.html#cb33-2"></a>using Plots</span>
<span id="cb33-3"><a href="normal-distributions-and-the-galton-board.html#cb33-3"></a>gr();</span>
<span id="cb33-4"><a href="normal-distributions-and-the-galton-board.html#cb33-4"></a>histogram(output, xlabel = <span class="st">"Bin"</span>, ylabel = <span class="st">"Count"</span>, </span>
<span id="cb33-5"><a href="normal-distributions-and-the-galton-board.html#cb33-5"></a>  legend=:false)</span></code></pre></div>
<p>Set the number of rows of pins in your Galton board R script to 10. Also set the number of balls to drop to a low value, say 10 to begin.
+ How does the histogram change as you repeatedly run the script?
+ What is the smallest number of balls that you can drop that gives more or less the same histogram each time you run the script, for 10 rows of pins?</p>
<div class="center">
<div class="info">
<p>We could also do this problem differently by sampling all the trajectories for all the balls simultaneously. We would do this by specifying a tuple for the <code>dims</code> argument of <code>rand()</code>. If we wanted to sample <code>nballs</code> ball paths at once, we could set <code>dims=(nballs, levels)</code> and the result will be formatted as an array with <code>nballs</code> rows and <code>levels</code> columns. We would then iterate over the array and sum to get the final positions for each of the <code>nballs</code>.</p>
</div>
</div>
</div>
<div id="part-2-1" class="section level3 unlisted unnumbered">
<h3>Part 2<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('part-2-1')" onmouseout="reset_tooltip('part-2-1-tooltip')"><span class="tooltiptext" id="part-2-1-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>Add commands to your Julia script so that it also generates a Q-Q plot for the results in <code>output</code>.</p>
<p>Recall from the discussion above that a Galton board only gives an approximately-normal distribution if both the number of balls that are dropped and the number of bins are large. Leaving the number of rows of pins at 10, increase the number of balls to a large value like 10<sup>4</sup> (in code, that would be just <code>10^4</code>). Confirm that the <code>output</code> under these circumstances is not normally distributed. How large does the number of rows of pins have to be to get approximately-normal results?</p>
</div>
<div id="part-3" class="section level3 unlisted unnumbered">
<h3>Part 3<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('part-3')" onmouseout="reset_tooltip('part-3-tooltip')"><span class="tooltiptext" id="part-3-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>Generate Q-Q plots for two commonly-used data sets,</p>
<ul>
<li>the <a href="https://www.rdocumentation.org/packages/datasets/versions/3.6.2/topics/faithful">waiting time between Old Faithful eruptions</a>, and</li>
<li>the <a href="https://www.rdocumentation.org/packages/datasets/versions/3.6.2/topics/iris">sepal length of setosa irises on the Gaspe Peninsula</a>.</li>
</ul>
<ol style="list-style-type: decimal">
<li>Install and load the <code>RDatasets</code> package.</li>
<li>Load the Old Faithful (<code>dataset("datasets", "faithful")[:, 2]</code>) and iris sepal (<code>dataset("datasets", "iris3")[:, 1, 1]</code>) datasets.</li>
<li>Generate your Q-Q plots.</li>
</ol>
<p>Which of these datasets is approximately normally distributed, and which is not? How can you tell?</p>

</div>
</div>
</div></body></html>

<p style="text-align: center;">
<a href="plotting-time-series-data.html"><button class="btn btn-default">Previous</button></a>
<a href="markov-chain-monte-carlo.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2021-12-15
 using 
R version 4.1.2 (2021-11-01)
</p>
</div>
</div>



</body>
</html>
