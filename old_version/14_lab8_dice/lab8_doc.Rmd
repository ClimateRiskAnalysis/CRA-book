---
title: 'Exercise #8: Climate policy and the DICE model'
author: 'Patrick Applegate, patrick.applegate@psu.edu; Greg Garner, ggg121@psu.edu; Richard Alley, rba6@psu.edu, and Klaus Keller, klaus@psu.edu'
output:
  pdf_document:
    fig_caption: yes
---

<!-- Copyright 2015 by the Authors -->

<!-- This file is part of Risk Analysis in the Earth Sciences: A Lab Manual with Exercises in R. -->

<!-- This e-textbook is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. -->

<!-- This e-textbook is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details. -->

<!-- You should have received a copy of the GNU General Public License along with this e-textbook.  If not, see <http://www.gnu.org/licenses/>. -->

# Learning Goals

After completing this exercise, you should be able to

* describe what the social cost of carbon (SCC) is
* explain in broad terms what the DICE model is and how it works
* perform simple calculations with the DICE model
* describe how uncertainties in the climate sensitivity affect the present-day social cost of carbon

# Introduction

As noted in the Introduction, fossil fuel use creates benefits for people, but also imposes costs in the form of climate change.  Burning fossil fuels releases energy but also byproducts such as carbon dioxide.  The energy leads to economic productivity.  However, the carbon dioxide causes long-lasting temperature increases, which lead to increased risks for people in the future and to a projected suite of overall negative impacts.  

Because fossil fuel users pay less than the full cost associated with their actions, emissions of carbon dioxide are larger than the economically-optimal amount.  An individual fossil fuel user pays an amount of money per unit of energy that represents the cost of extraction, processing (for example, gasoline is a highly processed derivative of oil), transportation, and profits, plus taxes and minus any subsidies.  This cost does not reflect the projected overall negative impacts associated with climate change.  Because people respond to price signals, they tend to consume more fossil fuel than they would if the price reflected the full cost to society of fossil fuel consumption (and were therefore higher).  

The [social cost of carbon](https://en.wikipedia.org/wiki/Carbon_tax#Social_cost_of_carbon) (SCC) are the monetised impacts of one addiitonal ton of carbon (in the form of carbon dioxide) emissions to the atmosphere.  In 2010, the US Environmental Protection Agency estimated a value for the SCC of about \$21/t CO$_2$ (Interagency Working Group on Social Cost of Carbon, 2010, 2013).  

The [Dynamic Integrated model of Climate and the Economy](http://www.econ.yale.edu/~nordhaus/homepage/Web-DICE-2013-April.htm) (DICE; Nordhaus, 2013; Nordhaus and Sztorc, 2013) includes simple representations of feedbacks between the climate system and the economy that are needed for estimating the SCC.  As discussed previously, greenhouse gas emissions cause temperature increases, which cause climate-related damages to the economy.  These damages can then motivate the development of policies and technologies that reduce emissions and possibly remove greenhouse gases from the atmosphere.  A model like DICE "closes the loop" between climate change and further emissions. This is a necessary step towards estimating future damages and therefore the SCC.  DICE is one of three models used by the EPA to estimate the social cost of carbon.  

DICE is often used to identify optimal climate policies (sometimes subject to different constraints).  When run in optimization mode, DICE maximizes a "utility function" that includes discounting as well as the declining marginal benefit of additional consumption.  Put simply, richer societies benefit less from an additional dollar of income than poorer ones.  

However, before DICE can be optimized, one needs to make a choice about model parameters such as the [climate sensitivity](https://en.wikipedia.org/wiki/Climate_sensitivity), among other parameters.  As we saw in the Introduction, the climate sensitivity represents the amount by which global mean air temperatures would increase if carbon dioxide concentrations in the atmosphere were to double.  Although many studies have estimated the climate sensitivity, this parameter remains deeply uncertain (e.g., Urban and Keller, 2009, 2010; Olson et al, 2012)

In this exercise, we use DICE to investigate how different climate and economic variables might change in the future under an optimized climate policy, plus how different values of the climate sensitivity affect the present value of the SCC.  

# Tutorial

The version of the DICE model that we use here was translated to R by Greg Garner from an original version in the GAMS language provided by Bill Nordhaus.  The `dice.R` file contains the following useful functions (among others): 

* `dice.new()`: creating a new instance of the DICE model with a prechosen set of parameters
* `dice.modify()`: changing the value of model parameters in DICE
* `dice.run()`: running the DICE model into the future using a given set of parameters
* `dice.solve()`: identifying an optimal trajectory using the utility function sketched above

Open `lab8_sample.R` in RStudio and examine the code that it contains.  The following lines of code explain who wrote the code, describe what the code does, `source()`s the file containing the DICE model, and loads the DICE model into memory using the `dice.new()` function.  

```{r eval = FALSE}
# lab8_done.R
# Patrick Applegate, patrick.applegate@psu.edu; Greg Garner, ggg121@psu.edu
# 
# Optimizes the DICE model to produce a plausible climate-economic trajectory
# and performs a Monte Carlo experiment to evaluate the effects of uncertainty
# in the climate sensitivity on the present-day social cost of carbon.  

# Mise en place.  
rm(list = ls())
graphics.off()

# Load the DICE model.  
source('dice.R')

# Create a new DICE object.  
my.dice <- dice.new()
```

Next, we optimize the DICE model using the utility function described in the Introduction and pull some time-dependent output out of the object that results.  

```{r eval = FALSE}
# Solve the DICE object for the optimal control policy.  
# NOTE: THIS STEP MAY TAKE A COUPLE OF MINUTES!  
dice.solve(my.dice)

# Set sensible names for the time-dependent variables to extract from DICE.  
names <- c('Time (yr)', 
           'Emissions (Gt CO_2/yr)', 
           'Atmospheric [CO_2] (ppm)', 
           'Global mean T anomaly (C)', 
           'Climate damages (10^12 $)', 
           'Social cost of carbon ($/t CO_2)')

# Make a place to store time-dependent output from optimized DICE.  
opt.output <- matrix(data = NA, nrow = length(my.dice$year), ncol = 6)
colnames(opt.output) <- names

# Put the time.dependent output from optimized DICE into opt.output.  
opt.output[, 1] <- my.dice$year
opt.output[, 2] <- my.dice$e
opt.output[, 3] <- my.dice$mat
opt.output[, 4] <- my.dice$tatm
opt.output[, 5] <- my.dice$damages
opt.output[, 6] <- my.dice$scc
```

The script also makes a plot of the time-dependent output.  

```{r eval = FALSE}
# Plot the time-dependent output from the optimized DICE object.  
pdf('lab8_plot1.pdf', width = 5, height = 8.5)
par(mfrow = c(5, 1))
plot(opt.output[, 1], opt.output[, 2], type = 'l', bty = 'n', xlab = names[1], 
     ylab = names[2])
plot(opt.output[, 1], opt.output[, 3], type = 'l', bty = 'n', xlab = names[1], 
     ylab = names[3])
plot(opt.output[, 1], opt.output[, 4], type = 'l', bty = 'n', xlab = names[1], 
     ylab = names[4])
plot(opt.output[, 1], opt.output[, 5], type = 'l', bty = 'n', xlab = names[1], 
     ylab = names[5])
plot(opt.output[, 1], opt.output[, 6], type = 'l', bty = 'n', xlab = names[1], 
     ylab = names[6])
dev.off()
```

## Running DICE in optimization mode and examining its time-varying output

Execute `lab8_sample.R` using the `source()` command or button (remember to set your working directory first), and look at the `.pdf` file that results.  It should look like Figure 1.  

<div class="centered">

![Time-dependent output from the optimized DICE model using the built-in parameter set.  See text for discussion.](figures/lab8_plot1.pdf)

</div>

Several interesting observations come out of Figure 1: 

1. Each model curve bends sharply upward in the last few decades.
2. Ignoring the last few decades of model results, the peak of each curve is lagged in time relative to the peak of the preceding curve; so, peak temperatures occur after peak carbon dioxide concentrations, which occur after peak emissions.
3. The social cost of carbon is not constant; it starts out relatively small and grows over time until about 2200, when it begins to decline again.

We can ignore the last few decades of each time series shown in Figure 1.  The DICE model assumes, in effect, that the world ends shortly after 2300 and that this apocalypse is known in advance, so that the people of the world start burning fossil fuels again.  

**Greg, can you write some text here to explain points 2 and 3?**

The script also prints out the assumed climate sensitivity value and the present-day social cost of carbon (`opt.scc <- opt.output[1, 6]`) obtained using the optimization.  

```{r eval = FALSE}
# Also extract the preset climate sensitivity and social cost of carbon
# from the DICE object.  
opt.t2xco2 <- my.dice$t2xco2
opt.scc <- opt.output[1, 6]

# Print some key quantities.  
print(sprintf('The assumed climate sensitivity for optimization is %2.2f C/doubling', 
              opt.t2xco2))
print(sprintf('The optimized social cost of carbon in %d is $%4.2f/t CO_2', 
              opt.output[1, 1], opt.scc))
```

## Accounting for uncertainty in the climate sensitivity

The DICE model discussed above assumes a climate sensitivity value of 2.9 C per doubling of CO$_2$ concentration in the atmosphere.  Although this value is reasonable, this point estimate does not capture the uncertainty in the actual value of the climate sensitivity.  If we were to change this parameter within reasonable limits, we would get different climate and economic trajectories (Fig. 1), and a different present-day value for the social cost of carbon.  

We could account for the effects of uncertainty in the climate sensitivity on present-day social cost of carbon values by performing a Monte Carlo experiment; however, we would first need a well-defined distribution for the climate sensitivity.  We could then run DICE repeatedly with climate sensitivity values sampled from this distribution and examine the distribution of present-day social cost of carbon values that came out.  

One *approximate* method involves matching a lognormal distribution to the probabilistic statements of the Intergovernmental Panel on Climate Change on climate sensitivity.  The lognormal distribution is only defined for positive values, and is therefore appropriate for variables like climate sensitivity that are estimated to be positive.  The latest IPCC report says, "Equilibrium climate sensitivity is... extremely unlikely less than 1°C... and very unlikely greater than 6°C..." (Alexander et al., 2013).  Mastrandrea et al. (2010, their Table 1) suggest that "extremely unlikely" corresponds to a likelihood of 0-5%, and "very unlikely" corresponds to a likelihood of 0-10%.  

The following code block accomplishes an approximate matching, assuming the largest likelihood values for "extremely unlikely" and "very unlikely" (5% and 10%, respectively).  It also generates a vector of random values from the resulting distribution.  

```{r eval = FALSE}
# Set some values.  
xs <- c(1, 6)       # climate sensitivities corresponding to the probabilities 
                    # in ps
ps <- c(0.05, (1- 0.1))
                    # (approximate) probabilities of the climate sensitivity
                    # being less than xs[1] or greater than xs[2], according 
                    # to IPCC AR5 WG1
n.trials <- 300     # number of Monte Carlo trials

# Define a function for matching the lognormal distribution to two (or more)
# tie points.  
lnorm.rmse <- function(dist.params, xs, ps) {
  # dist.params, vector of meanlog and sdlog values; 
  # see help(dlnorm)
  # xs, vector of values of the distributed variable to match
  # ps, probabilities of the values in xs
  logmu <- dist.params[1]
  logsigma <- dist.params[2]
  trial.xs <- qlnorm(ps, logmu, logsigma)
  rmse <- sqrt(mean((xs- trial.xs)^ 2))
  return(rmse)
}

# Identify the parameters of the lognormal distribution that produce the best
# match to the IPCC's statements about climate sensitivity.  
lnorm.optim <- optim(log(c(2.9, 1.5)), lnorm.rmse, gr = NULL, xs = xs, ps = ps, 
                     method = 'L-BFGS-B', lower = c(0, 0), upper = c(Inf, Inf))

# Generate a vector of climate sensitivity values.  
set.seed(1)
tx2co2s <- rlnorm(n.trials, meanlog = lnorm.optim$par[1], 
                  sdlog = lnorm.optim$par[2])
```

# Exercise

Make a copy of `lab8_sample.R` by saving it under a different file name.  Modify this copy so that it performs the Monte Carlo experiment described above using a `for` loop, with `n.trials <- 300` samples.  For each value in `tx2co2s`, you'll need to

1. set the value of climate sensitivity in DICE using `dice.modify(my.dice, "t2xco2", tx2co2s[i])`
2. run the DICE model using `dice.run(my.dice)`
3. extract the 2010 value of the social cost of carbon from the DICE object and store it in the `i`th element of a vector `sccs`

Your modified script should make a plot with two panels.  The top panel should show the distribution of climate sensitivity values based on fitting a lognormal distribution to the IPCC's probabilistic statement, with a vertical line to show DICE's default climate sensitivity value.  The bottom panel should show the distribution of present-day social cost of carbon values that you obtained from your Monte Carlo experiment, with vertical lines showing the mean of these values and the social cost of carbon value from optimizing DICE with the default parameter values.  

# Questions

1. The mean social cost of carbon from your Monte Carlo experiment reflects an estimate of the social cost of carbon given our remaining uncertainty in climate sensitivity.  Is this value higher or lower than the social cost of carbon value from optimizing DICE with the base parameters?  How much higher or lower is it?  Express your answer as a percentage.
2. How sensitive is your answer to question 1 to the likelihoods you assign to "extremely unlikely" and "very unlikely," given the likelihood ranges specified for these terms by Mastrandrea et al (2010, their Table 1)?  Does one bound have more of an effect on the mean social cost of carbon from your Monte Carlo experiments than the other?
3. If we are uncertain about the actual value of climate sensitivity, should we spend more or less money on reducing carbon dioxide emissions now, compared to a case in which we are sure about the value of climate sensitivity?  Justify your answer based on your responses to questions 1 and 2.

# References

Alexander, L. V., et al., 2013.  Summary for policymakers.  In Stocker, T. F., et al., eds., Climate Change 2013: The Physical Science Basis. Contribution of Working Group I to the Fifth Assessment Report of the Intergovernmental Panel on Climate Change, Cambridge University Press.  Available online at http://www.climatechange2013.org/report/full-report/  

Interagency Working Group on Social Cost of Carbon, 2010.  Technical Support Document: Social Cost of Carbon for Regulatory Impact Analysis Under Executive Order 12866.  Available online at www.epa.gov/otaq/climate/regulations/scc-tsd.pdf

Interagency Working Group on Social Cost of Carbon, 2013.  Technical Support Document: Technical Update of the Social Cost of Carbon for Regulatory Impact Analysis Under Executive Order 12866.  Available online at https://www.whitehouse.gov/sites/default/files/omb/inforeg/social_cost_of_carbon_for_ria_2013_update.pdf


Mastrandrea, M. D., et al., 2010.  Guidance Note for Lead Authors of the IPCC Fifth Assessment Report on Consistent Treatment of Uncertainties.  Available online at https://www.ipcc.ch/pdf/supporting-material/uncertainty-guidance-note.pdf

Nordhaus, W., 2013.  The Climate Casino: Risk, Uncertainty, and Economics for a Warming World.  Yale University Press, 378 p.

Nordhaus, W., and Sztorc, P., 2013.  DICE 2013R: Introduction and User’s Manual (2nd ed).  Available online at http://www.econ.yale.edu/~nordhaus/homepage/documents/DICE_Manual_103113r2.pdf

Olson, R., R. Sriver, M. Goes, N. M. Urban, H. D. Matthews, M. Haran, and K. Keller (2012), A climate sensitivity estimate using global average observations and an Earth System model, Journal of Geophysical Research, Atmosphere, 117, D04103, doi:04110.01029/02011JD016620.

Urban, N. M. and K. Keller: Complementary observational constraints on climate sensitivity, Geophysical Research Letters, L04708, doi:10.1029/2008GL036457 (2009).

Urban, N. M. and K. Keller: Probabilistic hindcasts and projections of the coupled climate, carbon cycle, and Atlantic meridional overturning circulation systems: A Bayesian fusion of century-scale observations with a simple model, Tellus A, 62(5), 737-750, (2010).


