<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 Tutorial | Risk Analysis in the Earth Sciences</title>
  <meta name="description" content="3.2 Tutorial | Risk Analysis in the Earth Sciences" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 Tutorial | Risk Analysis in the Earth Sciences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/cover_with_alexander.png" />
  
  <meta name="github-repo" content="scrim-network/raes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Tutorial | Risk Analysis in the Earth Sciences" />
  
  
  <meta name="twitter:image" content="/images/cover_with_alexander.png" />

<meta name="author" content="Vivek Srikrishnan" />
<meta name="author" content="Klaus Keller" />


<meta name="date" content="2021-12-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-2.html"/>
<link rel="next" href="exercises.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Risk Analysis in the Earth Sciencese</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="about-this-book.html"><a href="about-this-book.html"><i class="fa fa-check"></i>About This Book</a><ul>
<li class="chapter" data-level="" data-path="contributor-bios.html"><a href="contributor-bios.html"><i class="fa fa-check"></i>Contributor Bios</a></li>
<li class="chapter" data-level="" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="book-source-and-scripts.html"><a href="book-source-and-scripts.html"><i class="fa fa-check"></i>Book Source and Scripts</a></li>
<li class="chapter" data-level="" data-path="comments-and-questions.html"><a href="comments-and-questions.html"><i class="fa fa-check"></i>Comments and Questions</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="climate-risks.html"><a href="climate-risks.html"><i class="fa fa-check"></i><b>1.1</b> Climate Risks</a></li>
<li class="chapter" data-level="1.2" data-path="some-questions.html"><a href="some-questions.html"><i class="fa fa-check"></i><b>1.2</b> Some Questions</a></li>
<li class="chapter" data-level="1.3" data-path="types-of-uncertainty.html"><a href="types-of-uncertainty.html"><i class="fa fa-check"></i><b>1.3</b> Types of (Un)certainty</a></li>
<li class="chapter" data-level="1.4" data-path="what-is-risk.html"><a href="what-is-risk.html"><i class="fa fa-check"></i><b>1.4</b> What is Risk?</a></li>
<li class="chapter" data-level="1.5" data-path="uncertainty-vs.-risk.html"><a href="uncertainty-vs.-risk.html"><i class="fa fa-check"></i><b>1.5</b> “Uncertainty” vs. “Risk”</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="julia-syntax.html"><a href="julia-syntax.html"><i class="fa fa-check"></i><b>2</b> Learning the basics of Julia</a><ul>
<li class="chapter" data-level="" data-path="julia-syntax.html"><a href="julia-syntax.html#learning-objectives"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="2.1" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2.2</b> Getting Started</a><ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started.html"><a href="getting-started.html#why-julia"><i class="fa fa-check"></i><b>2.2.1</b> Why Julia?</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started.html"><a href="getting-started.html#installing-julia"><i class="fa fa-check"></i><b>2.2.2</b> Installing Julia</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started.html"><a href="getting-started.html#why-write-scripts"><i class="fa fa-check"></i><b>2.2.3</b> Why write scripts?</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started.html"><a href="getting-started.html#package-and-environment-management"><i class="fa fa-check"></i><b>2.2.4</b> Package and environment management</a></li>
<li class="chapter" data-level="2.2.5" data-path="getting-started.html"><a href="getting-started.html#getting-help"><i class="fa fa-check"></i><b>2.2.5</b> Getting help</a></li>
<li class="chapter" data-level="2.2.6" data-path="getting-started.html"><a href="getting-started.html#when-the-documentation-and-searching-the-internet-dont-help"><i class="fa fa-check"></i><b>2.2.6</b> When the documentation and searching the Internet don’t help</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="julia-syntax-1.html"><a href="julia-syntax-1.html"><i class="fa fa-check"></i><b>2.3</b> Julia Syntax</a><ul>
<li class="chapter" data-level="2.3.1" data-path="julia-syntax-1.html"><a href="julia-syntax-1.html#comments"><i class="fa fa-check"></i><b>2.3.1</b> Comments</a></li>
<li class="chapter" data-level="2.3.2" data-path="julia-syntax-1.html"><a href="julia-syntax-1.html#variables"><i class="fa fa-check"></i><b>2.3.2</b> Variables</a></li>
<li class="chapter" data-level="2.3.3" data-path="julia-syntax-1.html"><a href="julia-syntax-1.html#data-types"><i class="fa fa-check"></i><b>2.3.3</b> Data Types</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>2.4</b> Data Structures</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="plotting-time-series-data.html"><a href="plotting-time-series-data.html"><i class="fa fa-check"></i><b>3</b> Plotting Time Series Data</a><ul>
<li class="chapter" data-level="" data-path="plotting-time-series-data.html"><a href="plotting-time-series-data.html#learning-objectives-1"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="3.1" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="tutorial.html"><a href="tutorial.html"><i class="fa fa-check"></i><b>3.2</b> Tutorial</a><ul>
<li class="chapter" data-level="3.2.1" data-path="tutorial.html"><a href="tutorial.html#downloading-the-data"><i class="fa fa-check"></i><b>3.2.1</b> Downloading the Data</a></li>
<li class="chapter" data-level="3.2.2" data-path="tutorial.html"><a href="tutorial.html#reading-the-data"><i class="fa fa-check"></i><b>3.2.2</b> Reading the Data</a></li>
<li class="chapter" data-level="3.2.3" data-path="tutorial.html"><a href="tutorial.html#plotting-the-data"><i class="fa fa-check"></i><b>3.2.3</b> Plotting the Data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>3.3</b> Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#part-1"><i class="fa fa-check"></i>Part 1</a></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#part-2"><i class="fa fa-check"></i>Part 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="normal-distributions-and-the-galton-board.html"><a href="normal-distributions-and-the-galton-board.html"><i class="fa fa-check"></i><b>4</b> Normal distributions and the Galton board</a><ul>
<li class="chapter" data-level="" data-path="normal-distributions-and-the-galton-board.html"><a href="normal-distributions-and-the-galton-board.html#learning-objectives-2"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="4.1" data-path="introduction-3.html"><a href="introduction-3.html"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="tutorial-1.html"><a href="tutorial-1.html"><i class="fa fa-check"></i><b>4.2</b> Tutorial</a><ul>
<li class="chapter" data-level="4.2.1" data-path="tutorial-1.html"><a href="tutorial-1.html#writing-our-own-simple-galton-board-script"><i class="fa fa-check"></i><b>4.2.1</b> Writing our own simple Galton board script</a></li>
<li class="chapter" data-level="4.2.2" data-path="tutorial-1.html"><a href="tutorial-1.html#doing-things-over-and-over-again-for-loops"><i class="fa fa-check"></i><b>4.2.2</b> Doing things over and over again: <code>for</code> loops</a></li>
<li class="chapter" data-level="4.2.3" data-path="tutorial-1.html"><a href="tutorial-1.html#normal-or-not-normal-generating-and-interpreting-quantile-quantile-plots"><i class="fa fa-check"></i><b>4.2.3</b> Normal or not normal?: Generating and interpreting quantile-quantile plots</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>4.3</b> Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercises-1.html"><a href="exercises-1.html#part-1-1"><i class="fa fa-check"></i>Part 1</a></li>
<li class="chapter" data-level="" data-path="exercises-1.html"><a href="exercises-1.html#part-2-1"><i class="fa fa-check"></i>Part 2</a></li>
<li class="chapter" data-level="" data-path="exercises-1.html"><a href="exercises-1.html#part-3"><i class="fa fa-check"></i>Part 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Risk Analysis in the Earth Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tutorial" class="section level2">
<h2><span class="header-section-number">3.2</span> Tutorial</h2>
<p>We’ll start by looking at several Web pages that describe the data we’ll be using in this exercise. As of May 2015, the various data sets displayed in Figure <a href="introduction-2.html#fig:co2tempslr">3.1</a> are archived in the following places:</p>
<table>
<caption><span id="tab:climatedata">Table 3.1: </span> Internet sources of data used in Exercise #1 and associated references. NOAA, National Oceanic and Atmospheric Administration; DOE CDIAC, United States Department of Energy – Carbon Dioxide Analysis Center; NASA GISS, National Aeronautics and Space Administration – Goddard Institute for Space Studies; PSMSL, Permanent Service for Mean Sea Level.</caption>
<thead>
<tr class="header">
<th>Data type</th>
<th>Reference</th>
<th>Location on the Web</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CO<sub>2</sub>, direct measurements</td>
<td><span class="citation">Keeling et al. (<a href="#ref-Keeling1976-bc" role="doc-biblioref">1976</a>)</span></td>
<td><a href="http://www.esrl.noaa.gov/gmd/ccgg/trends/">NOAA</a></td>
</tr>
<tr class="even">
<td>CO<sub>2</sub>, Law Dome ice core</td>
<td><span class="citation">MacFarling Meure et al. (<a href="#ref-MacFarling_Meure2006-wa" role="doc-biblioref">2006</a>)</span></td>
<td><a href="http://cdiac.ornl.gov/trends/co2/modern_co2.html">DOE CDIAC</a></td>
</tr>
<tr class="odd">
<td>Surface air temperature change</td>
<td><span class="citation">Hansen et al. (<a href="#ref-Hansen2010-wg" role="doc-biblioref">2010</a>)</span></td>
<td><a href="http://data.giss.nasa.gov/gistemp/">NASA GISS</a></td>
</tr>
<tr class="even">
<td>Sea level anomaly</td>
<td><span class="citation">Jevrejeva et al. (<a href="#ref-Jevrejeva2014-my" role="doc-biblioref">2014</a>)</span></td>
<td><a href="http://www.psmsl.org/products/reconstructions/jevrejevaetal2014.php">PSMSL</a></td>
</tr>
</tbody>
</table>
<p>Click on the links in the right-hand column of Table <a href="tutorial.html#tab:climatedata">3.1</a> and look at the descriptions of the data stored there. Also look for links to the particular data sets mentioned in the Introduction. Some Web pages contain links to multiple data sets; we want the “<a href="ftp://aftp.cmdl.noaa.gov/products/trends/co2/co2_mm_mlo.txt">Mauna Loa CO<sub>2</sub> monthly mean data</a>,” <a href="ftp://ftp.ncdc.noaa.gov/pub/data/paleo/icecore/antarctica/law/law2006.txt">the Law Dome data</a> (scroll down to near the bottom of the page), and the “<a href="http://data.giss.nasa.gov/gistemp/tabledata_v3/GLB.Ts+dSST.txt">global-mean monthly, seasonal, and annual means, 1880-present, updated through most recent month</a>” of the "Land-Ocean Temperature Index, LOTI.</p>
<div id="downloading-the-data" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Downloading the Data</h3>
<p>Let’s step through how to make the first two panels of the plot above. Notice the liberal use of comments throughout the code; using comments like this is a good way to document your code and help yourself (and others!) interpret it.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb11-1"><a href="tutorial.html#cb11-1"></a><span class="co"># if &quot;data/&quot; does not exist, create it</span></span>
<span id="cb11-2"><a href="tutorial.html#cb11-2"></a>isdir(<span class="st">&quot;data&quot;</span>) || mkdir(<span class="st">&quot;data&quot;</span>); </span>
<span id="cb11-3"><a href="tutorial.html#cb11-3"></a><span class="co"># download files and save in &quot;data&quot;</span></span>
<span id="cb11-4"><a href="tutorial.html#cb11-4"></a>download(<span class="st">&quot;ftp://aftp.cmdl.noaa.gov/products/trends/co2/co2_mm_mlo.txt&quot;</span>, </span>
<span id="cb11-5"><a href="tutorial.html#cb11-5"></a>    <span class="st">&quot;data/co2_mm_mlo.txt&quot;</span>);</span>
<span id="cb11-6"><a href="tutorial.html#cb11-6"></a>download(<span class="st">&quot;ftp://ftp.ncdc.noaa.gov/pub/data/paleo/icecore/antarctica/law/law2006.txt&quot;</span>, </span>
<span id="cb11-7"><a href="tutorial.html#cb11-7"></a>    <span class="st">&quot;data/law2006.txt&quot;</span>);</span>
<span id="cb11-8"><a href="tutorial.html#cb11-8"></a>download(<span class="st">&quot;https://data.giss.nasa.gov/gistemp/tabledata_v3/GLB.Ts+dSST.txt&quot;</span>, </span>
<span id="cb11-9"><a href="tutorial.html#cb11-9"></a>    <span class="st">&quot;data/GLB.Ts+dSST.txt&quot;</span>);</span></code></pre></div>
<p>The first line creates a <code>data/</code> directory if one does not already exist. It actually contains a compound command. As discussed in Section <a href="#boolean-operators"><strong>??</strong></a>, <code>||</code> is a <em>short-circuit</em> or operator. In this context, it first evaluates <code>isdir("data")</code>, which is <code>true</code> if <code>data/</code> exists and is a directory and <code>false</code> if not. If <code>isdir("data")</code> is <code>true</code>, there is no need to continue. If <code>data/</code> does not exist and <code>isdir("data")</code> is <code>false</code>, then it evaluates <code>mkdir("data")</code>, which makes the <code>data/</code> directory. This is a useful alternative in Julia to the following code:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb12-1"><a href="tutorial.html#cb12-1"></a><span class="co"># if &quot;data/&quot; is not a directory, evaluate the rest</span></span>
<span id="cb12-2"><a href="tutorial.html#cb12-2"></a><span class="kw">if</span> ! isdir(<span class="st">&quot;data&quot;</span>) </span>
<span id="cb12-3"><a href="tutorial.html#cb12-3"></a>    <span class="co"># make the &quot;data/&quot; directory</span></span>
<span id="cb12-4"><a href="tutorial.html#cb12-4"></a>    mkdir(<span class="st">&quot;data&quot;</span>) </span>
<span id="cb12-5"><a href="tutorial.html#cb12-5"></a><span class="kw">end</span></span></code></pre></div>
<p>The <code>download(url, location)</code> commands download files and save them. The <code>url</code> argument is the source for the data, while <code>location</code> is the local path where the file should be saved.</p>
</div>
<div id="reading-the-data" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Reading the Data</h3>
<p>Now that we have the files, we need to read the information that they contain into Julia. One of the tricky things with reading files is that you have to know something about how the file is formatted to specify how the code should read it. Open each of the data files using a text editor and examine them. Which files contain “extra” information at the top or bottom of the file? In each file, which columns contain the information we need?</p>
<p>You may notice that these files are <em>tab-delimited</em>, which means that columns are separated using tabs. Ither files may be space-delimited or comma-delimited, also known as comma-separated or CSV files. With this sort of structure, we can read in the files using the <code>readdlm()</code> command, which is short for “read delimited.” <code>readdlm()</code> is from the <code>DelimitedFiles.jl</code> package, which means we need to load it. <code>DelimitedFiles.jl</code> comes with base Julia, so there’s no installation required:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb13-1"><a href="tutorial.html#cb13-1"></a>using DelimitedFiles <span class="co"># load DelimitedFiles.jl</span></span>
<span id="cb13-2"><a href="tutorial.html#cb13-2"></a></span>
<span id="cb13-3"><a href="tutorial.html#cb13-3"></a><span class="co"># begin reading in the data</span></span>
<span id="cb13-4"><a href="tutorial.html#cb13-4"></a><span class="co">#  read Mauna Loa CO2 Data</span></span>
<span id="cb13-5"><a href="tutorial.html#cb13-5"></a>loa_co2data = readdlm(<span class="st">&quot;data/co2_mm_mlo.txt&quot;</span>, skipstart=<span class="fl">57</span>, </span>
<span id="cb13-6"><a href="tutorial.html#cb13-6"></a>    header=false);</span>
<span id="cb13-7"><a href="tutorial.html#cb13-7"></a><span class="co"># read Law Dome CO2 Data</span></span>
<span id="cb13-8"><a href="tutorial.html#cb13-8"></a>law_co2data = readdlm(<span class="st">&quot;data/law2006.txt&quot;</span>, skipstart = <span class="fl">183</span>, </span>
<span id="cb13-9"><a href="tutorial.html#cb13-9"></a>    header = false)[<span class="fl">1</span>:<span class="fl">2004</span>, :]; </span></code></pre></div>
<p>In each of the <code>readdlm()</code> commands, the first argument is the file to open. Look at <a href="https://docs.julialang.org/en/v1/stdlib/DelimitedFiles/#Delimited-Files">the documentation for <code>readdlm()</code></a>. We also use two other options:
* <code>skipstart</code> skips the specified number of lines from the beginning of the file, which allows us to ignore headings and comments at the beginning of the file;
* <code>header = false</code> tells <code>readdlm()</code> not to interpret the first read line (after the skipped lines) as column headers for the resulting array.
We also tell Julia to only keep the first 2004 rows of the Law Dome data (after skipping the first 183 lines of the file). We do this because there is additional information at the bottom of the file that we do not need to keep.</p>
<p>The temperature data file is formatted in blocks, each of which contains about 20 years of data. For that reason, it is much more complicated to read into Julia. The code block below accomplishes this task using a <code>for</code> loop.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb14-1"><a href="tutorial.html#cb14-1"></a><span class="co"># read in temperature data; this requires reading in sections </span></span>
<span id="cb14-2"><a href="tutorial.html#cb14-2"></a><span class="co"># of the file one at a time</span></span>
<span id="cb14-3"><a href="tutorial.html#cb14-3"></a><span class="co"># specify the row numbers where each chunk of data begins</span></span>
<span id="cb14-4"><a href="tutorial.html#cb14-4"></a>start_rows = [<span class="fl">9</span>, <span class="fl">31</span>, <span class="fl">53</span>, <span class="fl">75</span>, <span class="fl">97</span>, <span class="fl">119</span>, <span class="fl">141</span>]; </span>
<span id="cb14-5"><a href="tutorial.html#cb14-5"></a><span class="co"># how many rows are in each chunk</span></span>
<span id="cb14-6"><a href="tutorial.html#cb14-6"></a>num_rows = [<span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">18</span>]; </span>
<span id="cb14-7"><a href="tutorial.html#cb14-7"></a><span class="co"># this computes the total amount of data before reading in </span></span>
<span id="cb14-8"><a href="tutorial.html#cb14-8"></a><span class="co"># each chunk, which we need to index the resulting array</span></span>
<span id="cb14-9"><a href="tutorial.html#cb14-9"></a>cum_num_rows = cumsum(num_rows); </span>
<span id="cb14-10"><a href="tutorial.html#cb14-10"></a><span class="co"># initialize the storage for the temperature data array</span></span>
<span id="cb14-11"><a href="tutorial.html#cb14-11"></a>temp_data = zeros(sum(num_rows), <span class="fl">20</span>); </span>
<span id="cb14-12"><a href="tutorial.html#cb14-12"></a><span class="co"># read in the first chunk</span></span>
<span id="cb14-13"><a href="tutorial.html#cb14-13"></a>temp_data[<span class="fl">1</span>:num_rows[<span class="fl">1</span>], :] = readdlm(<span class="st">&quot;data/GLB.Ts+dSST.txt&quot;</span>, </span>
<span id="cb14-14"><a href="tutorial.html#cb14-14"></a>    skipstart = start_rows[<span class="fl">1</span>], header = false)[<span class="fl">1</span>:num_rows[<span class="fl">1</span>], :]; </span>
<span id="cb14-15"><a href="tutorial.html#cb14-15"></a><span class="co"># loop over the remaining chunks and read them in</span></span>
<span id="cb14-16"><a href="tutorial.html#cb14-16"></a><span class="kw">for</span> i = <span class="fl">2</span>:length(start_rows)</span>
<span id="cb14-17"><a href="tutorial.html#cb14-17"></a>    temp_data[(cum_num_rows[i-<span class="fl">1</span>] + <span class="fl">1</span>):cum_num_rows[i], :] = </span>
<span id="cb14-18"><a href="tutorial.html#cb14-18"></a>        readdlm(<span class="st">&quot;data/GLB.Ts+dSST.txt&quot;</span>, skipstart = start_rows[i], </span>
<span id="cb14-19"><a href="tutorial.html#cb14-19"></a>            header = false)[<span class="fl">1</span>:num_rows[i], :];</span>
<span id="cb14-20"><a href="tutorial.html#cb14-20"></a><span class="kw">end</span></span></code></pre></div>
</div>
<div id="plotting-the-data" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Plotting the Data</h3>
<p>Finally, we make the figure. This requires loading the <code>Plots.jl</code> package (see <a href="http://docs.juliaplots.org/latest/">its documentation</a>), which provides plotting functionality. If this were our first time making plots in Julia, we would need to install <code>Plots</code>, which we would do using <code>Pkg</code>. These lines are commented out in the code below because we’ve already done this for this book.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb15-1"><a href="tutorial.html#cb15-1"></a><span class="co">## install and load relevant packages</span></span>
<span id="cb15-2"><a href="tutorial.html#cb15-2"></a><span class="co"># these two lines are commented out as we already have the </span></span>
<span id="cb15-3"><a href="tutorial.html#cb15-3"></a><span class="co"># `Plots` library installed; if we did not, we would need to </span></span>
<span id="cb15-4"><a href="tutorial.html#cb15-4"></a><span class="co"># include them</span></span>
<span id="cb15-5"><a href="tutorial.html#cb15-5"></a><span class="co"># using Pkg</span></span>
<span id="cb15-6"><a href="tutorial.html#cb15-6"></a><span class="co"># Pkg.add(&quot;Plots&quot;)</span></span>
<span id="cb15-7"><a href="tutorial.html#cb15-7"></a></span>
<span id="cb15-8"><a href="tutorial.html#cb15-8"></a><span class="co"># now we load `Plots.jl` as well as the `Plots.Measures` </span></span>
<span id="cb15-9"><a href="tutorial.html#cb15-9"></a><span class="co"># subpackage, which lets us refer to units like &quot;in&quot; and &quot;mm&quot;</span></span>
<span id="cb15-10"><a href="tutorial.html#cb15-10"></a>using Plots</span>
<span id="cb15-11"><a href="tutorial.html#cb15-11"></a>using Plots.Measures</span>
<span id="cb15-12"><a href="tutorial.html#cb15-12"></a><span class="co"># use GR backend; see text discussion</span></span>
<span id="cb15-13"><a href="tutorial.html#cb15-13"></a>gr(); </span>
<span id="cb15-14"><a href="tutorial.html#cb15-14"></a></span>
<span id="cb15-15"><a href="tutorial.html#cb15-15"></a><span class="co">## first plot CO2 data</span></span>
<span id="cb15-16"><a href="tutorial.html#cb15-16"></a><span class="co"># save the base Law Dome data plot as `p1`</span></span>
<span id="cb15-17"><a href="tutorial.html#cb15-17"></a>p1 = plot(law_co2data[:, <span class="fl">1</span>], law_co2data[:, <span class="fl">6</span>], color=<span class="st">&quot;black&quot;</span>, </span>
<span id="cb15-18"><a href="tutorial.html#cb15-18"></a>    label=<span class="st">&quot;Law Dome Ice Core Record&quot;</span>, legend=:top, grid=false);</span>
<span id="cb15-19"><a href="tutorial.html#cb15-19"></a><span class="co"># add the Mauna Loa data on top of the Law Dome data</span></span>
<span id="cb15-20"><a href="tutorial.html#cb15-20"></a>plot!(loa_co2data[:, <span class="fl">3</span>], loa_co2data[:, <span class="fl">5</span>], color=<span class="st">&quot;blue&quot;</span>, </span>
<span id="cb15-21"><a href="tutorial.html#cb15-21"></a>    label=<span class="st">&quot;Mauna Loa Measurements&quot;</span>); </span>
<span id="cb15-22"><a href="tutorial.html#cb15-22"></a><span class="co"># label the x-axis</span></span>
<span id="cb15-23"><a href="tutorial.html#cb15-23"></a>xlabel!(<span class="st">&quot;Year&quot;</span>); </span>
<span id="cb15-24"><a href="tutorial.html#cb15-24"></a><span class="co"># we only want to plot data after 1900 even though we have </span></span>
<span id="cb15-25"><a href="tutorial.html#cb15-25"></a><span class="co"># more from Law Dome</span></span>
<span id="cb15-26"><a href="tutorial.html#cb15-26"></a>xlims!((<span class="fl">1900</span>, <span class="fl">2020</span>)); </span>
<span id="cb15-27"><a href="tutorial.html#cb15-27"></a><span class="co"># label the y-axis</span></span>
<span id="cb15-28"><a href="tutorial.html#cb15-28"></a>ylabel!(<span class="st">&quot;Atmospheric CO₂ (ppm)&quot;</span>); </span>
<span id="cb15-29"><a href="tutorial.html#cb15-29"></a></span>
<span id="cb15-30"><a href="tutorial.html#cb15-30"></a><span class="co">## then plot temperature data</span></span>
<span id="cb15-31"><a href="tutorial.html#cb15-31"></a><span class="co"># save the base temperature data plot as `p2`</span></span>
<span id="cb15-32"><a href="tutorial.html#cb15-32"></a>p2 = plot(temp_data[:, <span class="fl">1</span>], temp_data[:, <span class="fl">14</span>] / <span class="fl">100</span>, </span>
<span id="cb15-33"><a href="tutorial.html#cb15-33"></a>    color=<span class="st">&quot;black&quot;</span>, legend=false, grid=false); </span>
<span id="cb15-34"><a href="tutorial.html#cb15-34"></a>xlabel!(<span class="st">&quot;Year&quot;</span>);</span>
<span id="cb15-35"><a href="tutorial.html#cb15-35"></a>xlims!((<span class="fl">1900</span>, <span class="fl">2020</span>));</span>
<span id="cb15-36"><a href="tutorial.html#cb15-36"></a>ylabel!(<span class="st">&quot;Global Mean Temperature Anomaly (K)&quot;</span>);</span>
<span id="cb15-37"><a href="tutorial.html#cb15-37"></a></span>
<span id="cb15-38"><a href="tutorial.html#cb15-38"></a><span class="co">## combine plots</span></span>
<span id="cb15-39"><a href="tutorial.html#cb15-39"></a><span class="co"># finally, combine the two plots as two subplot rows</span></span>
<span id="cb15-40"><a href="tutorial.html#cb15-40"></a>plot(p1, p2, layout= (<span class="fl">2</span>, <span class="fl">1</span>), left_margin=<span class="fl">20</span>mm, </span>
<span id="cb15-41"><a href="tutorial.html#cb15-41"></a>    right_margin=<span class="fl">20</span>mm); </span>
<span id="cb15-42"><a href="tutorial.html#cb15-42"></a><span class="co"># adjust the size so the final combined plot isn&#39;t squished </span></span>
<span id="cb15-43"><a href="tutorial.html#cb15-43"></a><span class="co"># together</span></span>
<span id="cb15-44"><a href="tutorial.html#cb15-44"></a>plot!(size=(<span class="fl">800</span>, <span class="fl">600</span>)) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:co2temp"></span>
<img src="raes_files/figure-html/co2temp-J1.png" alt="Plot results after running the code in this chapter. See text for discussion." width="75%" />
<p class="caption">
Figure 3.2: Plot results after running the code in this chapter. See text for discussion.
</p>
</div>
<p>Let’s walk through the code preceding Figure <a href="tutorial.html#fig:co2temp">3.2</a>. First, <code>Plots</code> <a href="http://docs.juliaplots.org/latest/backends/">uses various backends</a> to provide varying capabilities. We will use the basic <code>GR</code> backend, so we call <code>gr()</code> after loading <code>Plots</code> to set this up. Next, we plot the Law Dome data using the <code>plot()</code> function. The first argument to <code>plot()</code> contains the x-coordinates of the data; this is the column specifying the year. The second argument are the y-coordinates, which is the sixth column in the data. We can also set the color (<code>color=black</code>) and the legend label (<code>label="Law Dome Ice Core Record"</code>), since the atmospheric CO<sub>2</sub> plot will also include the Mauna Loa data. Finally, we set the legend position to be top-center with <code>legend=:top</code> (there are lots of options for legend placement), and turn off the grid corresponding to the axis tick marks with <code>grid=false</code>. Notice that by default, <code>plots()</code> will plot this data as a line, though we could also <a href="http://docs.juliaplots.org/latest/tutorial/#Changing-the-Plotting-Series">set it to plot the data as points</a> if desired.</p>
<p>Next, we want to overlay the Mauna Loa data. As discussed earlier, the presence of an exclamation mark after a function name (<code>plots!()</code> as opposed to <code>plots()</code>) means that the function will modify its argument in-place, rather than returning a new variable. This allows us to avoid creating a new set of axes. We color this data blue to distinguish it from the Law Dome data series. We then can add axis labels (using <code>xlabel!()</code> and <code>ylabel!()</code>, which once again modify the current plot rather than creating a new plot object) and change the limits (in this case, we only want to change the x-axis limits to crop the data to post-1900).</p>
<p>Why did we save this plot object in the <code>p1</code> variable? This will allow us to later include it as a subplot in a final combined plot.</p>
<p>The process of creating the second subplot panel, stored as <code>p2</code>, is similar, only we have just the single temperature series, so we never need to make a call to <code>plot!()</code> or set up a legend. In fact, we turn off the legend with <code>legend=:false</code>.</p>
<p>We can now create our combined, two-panel plot with a call to <code>plot()</code>. In this case, we can just specify the two variables which stored our panels, <code>p1</code> and <code>p2</code>, and provide a layout (in the form <code>(rows, cols)</code>). It turns out that in this case, doing this cuts off the left and right edges of the plot, so we set a larger margin with <code>left_margin</code> and <code>right_margin</code>. We can use intuitive units like <code>mm</code> because we loaded <code>Plots.Measures</code>. Lastly, we modify the size plotting region with <code>plot!(size=(800, 600))</code> to spread out the plot to 800 pixels wide by 600 pixels tall and avoid the two panels from running into each other.</p>
<p>What if we wanted to save our figure as a file? To do that, we would use <a href="http://docs.juliaplots.org/latest/output/#savefig-/-format"><code>savefig(filename)</code></a> to save the last plot object in memory to <code>filename</code>. <code>savefig()</code> automatically encodes the plot properly based on the specified file extension.</p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Hansen2010-wg">
<p>Hansen, J., Ruedy, R., Sato, M., &amp; Lo, K. (2010). Global surface temperature change. <em>Rev. Geophys.</em>, <em>48</em>(4), 644. <a href="https://doi.org/10.1029/2010RG000345">https://doi.org/10.1029/2010RG000345</a></p>
</div>
<div id="ref-Jevrejeva2014-my">
<p>Jevrejeva, S., Moore, J. C., Grinsted, A., Matthews, A. P., &amp; Spada, G. (2014). Trends and acceleration in global and regional sea levels since 1807. <em>Glob. Planet. Change</em>, <em>113</em>, 11–22. <a href="https://doi.org/10.1016/j.gloplacha.2013.12.004">https://doi.org/10.1016/j.gloplacha.2013.12.004</a></p>
</div>
<div id="ref-Keeling1976-bc">
<p>Keeling, C. D., Bacastow, R. B., Bainbridge, A. E., Ekdahl, C. A., Jr., Guenther, P. R., Waterman, L. S., &amp; Chin, J. F. S. (1976). Atmospheric carbon dioxide variations at mauna loa observatory, hawaii. <em>Tell’Us</em>, <em>28</em>(6), 538–551. <a href="https://doi.org/10.1111/j.2153-3490.1976.tb00701.x">https://doi.org/10.1111/j.2153-3490.1976.tb00701.x</a></p>
</div>
<div id="ref-MacFarling_Meure2006-wa">
<p>MacFarling Meure, C., Etheridge, D., Trudinger, C., Steele, P., Langenfelds, R., Ommen, T. van, et al. (2006). Law dome CO2 , CH4 and N2O ice core records extended to 2000 years BP. <em>Geophys. Res. Lett.</em>, <em>33</em>(14), 101. <a href="https://doi.org/10.1029/2006GL026152">https://doi.org/10.1029/2006GL026152</a></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercises.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["raes.pdf", "raes.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
